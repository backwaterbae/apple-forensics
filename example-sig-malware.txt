# Malware and Suspicious Activity Patterns
# Indicators of compromise and malicious behavior

# Malware Keywords
PARTIAL:malware|CATEGORY:Malware|SEVERITY:HIGH|DESC:Malware keyword detected
PARTIAL:virus|CATEGORY:Malware|SEVERITY:HIGH|DESC:Virus keyword detected
PARTIAL:trojan|CATEGORY:Malware|SEVERITY:HIGH|DESC:Trojan keyword detected
PARTIAL:backdoor|CATEGORY:Malware|SEVERITY:HIGH|DESC:Backdoor indicator
PARTIAL:rootkit|CATEGORY:Malware|SEVERITY:HIGH|DESC:Rootkit indicator
PARTIAL:keylogger|CATEGORY:Malware|SEVERITY:HIGH|DESC:Keylogger indicator
PARTIAL:ransomware|CATEGORY:Malware|SEVERITY:HIGH|DESC:Ransomware indicator
PARTIAL:spyware|CATEGORY:Malware|SEVERITY:HIGH|DESC:Spyware indicator

# Exploit Indicators
PARTIAL:exploit|CATEGORY:Exploit|SEVERITY:HIGH|DESC:Exploit indicator
PARTIAL:shellcode|CATEGORY:Exploit|SEVERITY:HIGH|DESC:Shellcode detected
PARTIAL:payload|CATEGORY:Exploit|SEVERITY:HIGH|DESC:Payload indicator
PARTIAL:buffer overflow|CATEGORY:Exploit|SEVERITY:HIGH|DESC:Buffer overflow
PARTIAL:heap overflow|CATEGORY:Exploit|SEVERITY:HIGH|DESC:Heap overflow
PARTIAL:stack overflow|CATEGORY:Exploit|SEVERITY:HIGH|DESC:Stack overflow

# CVE References
REGEX:CVE-\d{4}-\d+|CATEGORY:Vulnerability|SEVERITY:HIGH|DESC:CVE reference
PARTIAL:zero-day|CATEGORY:Vulnerability|SEVERITY:HIGH|DESC:Zero-day exploit

# Known macOS Malware Families
PARTIAL:shlayer|CATEGORY:Malware|SEVERITY:HIGH|DESC:OSX.Shlayer adware
PARTIAL:dacls|CATEGORY:Malware|SEVERITY:HIGH|DESC:OSX.Dacls RAT
PARTIAL:windtail|CATEGORY:Malware|SEVERITY:HIGH|DESC:OSX.WindTail backdoor
PARTIAL:evilquest|CATEGORY:Malware|SEVERITY:HIGH|DESC:OSX.EvilQuest ransomware
PARTIAL:adload|CATEGORY:Malware|SEVERITY:HIGH|DESC:Adload adware family
PARTIAL:pirrit|CATEGORY:Malware|SEVERITY:HIGH|DESC:Pirrit adware
PARTIAL:xloader|CATEGORY:Malware|SEVERITY:HIGH|DESC:XLoader malware
PARTIAL:xcsset|CATEGORY:Malware|SEVERITY:HIGH|DESC:XCSSET malware

# Adware/PUP
PARTIAL:bundlore|CATEGORY:Adware|SEVERITY:MEDIUM|DESC:Bundlore adware
PARTIAL:genieo|CATEGORY:Adware|SEVERITY:MEDIUM|DESC:Genieo adware
PARTIAL:crossrider|CATEGORY:Adware|SEVERITY:MEDIUM|DESC:Crossrider adware
PARTIAL:searchmine|CATEGORY:Adware|SEVERITY:MEDIUM|DESC:SearchMine adware
PARTIAL:mackeeper|CATEGORY:PUP|SEVERITY:MEDIUM|DESC:MacKeeper PUP

# Suspicious Processes
PARTIAL:cryptominer|CATEGORY:Malware|SEVERITY:HIGH|DESC:Cryptocurrency miner
PARTIAL:mining|CATEGORY:Suspicious|SEVERITY:MEDIUM|DESC:Possible mining activity
PARTIAL:credential dump|CATEGORY:Malware|SEVERITY:HIGH|DESC:Credential dumping
PARTIAL:password stealer|CATEGORY:Malware|SEVERITY:HIGH|DESC:Password stealing

# Persistence Mechanisms
PARTIAL:launchd plist|CATEGORY:Persistence|SEVERITY:MEDIUM|DESC:LaunchD plist modification
PARTIAL:login item|CATEGORY:Persistence|SEVERITY:MEDIUM|DESC:Login item added
PARTIAL:startup item|CATEGORY:Persistence|SEVERITY:MEDIUM|DESC:Startup item
PARTIAL:cron job|CATEGORY:Persistence|SEVERITY:MEDIUM|DESC:Cron job added
REGEX:~/\.bash.*profile|CATEGORY:Persistence|SEVERITY:MEDIUM|DESC:Shell profile modification

# Suspicious Paths
REGEX:/tmp/\.|CATEGORY:Suspicious|SEVERITY:MEDIUM|DESC:Hidden file in /tmp
REGEX:/var/tmp/\.|CATEGORY:Suspicious|SEVERITY:MEDIUM|DESC:Hidden file in /var/tmp
PARTIAL:/dev/shm|CATEGORY:Suspicious|SEVERITY:MEDIUM|DESC:Shared memory usage
REGEX:~\/\..*rc$|CATEGORY:Suspicious|SEVERITY:LOW|DESC:Hidden rc file

# Code Injection
PARTIAL:inject|CATEGORY:Malware|SEVERITY:HIGH|DESC:Code injection indicator
PARTIAL:ptrace|CATEGORY:Suspicious|SEVERITY:MEDIUM|DESC:Process tracing (ptrace)
PARTIAL:dyld_insert|CATEGORY:Malware|SEVERITY:HIGH|DESC:Dynamic library injection
PARTIAL:task_for_pid|CATEGORY:Suspicious|SEVERITY:MEDIUM|DESC:Task port access

# Network C2 Indicators
PARTIAL:command and control|CATEGORY:Network|SEVERITY:HIGH|DESC:C2 communication
PARTIAL:c2 server|CATEGORY:Network|SEVERITY:HIGH|DESC:C2 server reference
PARTIAL:beacon|CATEGORY:Network|SEVERITY:HIGH|DESC:Beaconing activity
REGEX:callback.*\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}|CATEGORY:Network|SEVERITY:HIGH|DESC:Network callback

# Data Exfiltration
PARTIAL:exfiltration|CATEGORY:Exfiltration|SEVERITY:HIGH|DESC:Data exfiltration
PARTIAL:data theft|CATEGORY:Exfiltration|SEVERITY:HIGH|DESC:Data theft indicator
PARTIAL:unauthorized transfer|CATEGORY:Exfiltration|SEVERITY:HIGH|DESC:Unauthorized data transfer
REGEX:upload.*\d+\s*(mb|gb)|CATEGORY:Exfiltration|SEVERITY:MEDIUM|DESC:Large upload

# Suspicious Scripts
PARTIAL:base64|CATEGORY:Suspicious|SEVERITY:MEDIUM|DESC:Base64 encoding (possible obfuscation)
PARTIAL:eval(|CATEGORY:Suspicious|SEVERITY:MEDIUM|DESC:Eval function (code execution)
PARTIAL:exec(|CATEGORY:Suspicious|SEVERITY:MEDIUM|DESC:Exec function
REGEX:curl.*\|.*sh|CATEGORY:Suspicious|SEVERITY:HIGH|DESC:Curl pipe to shell
REGEX:wget.*\|.*sh|CATEGORY:Suspicious|SEVERITY:HIGH|DESC:Wget pipe to shell

# Obfuscation
PARTIAL:obfuscated|CATEGORY:Suspicious|SEVERITY:HIGH|DESC:Obfuscated code
PARTIAL:encoded|CATEGORY:Suspicious|SEVERITY:MEDIUM|DESC:Encoded content
PARTIAL:packed|CATEGORY:Suspicious|SEVERITY:MEDIUM|DESC:Packed binary

# Reverse Shell
PARTIAL:reverse shell|CATEGORY:Malware|SEVERITY:HIGH|DESC:Reverse shell indicator
PARTIAL:bind shell|CATEGORY:Malware|SEVERITY:HIGH|DESC:Bind shell indicator
REGEX:nc.*-e|CATEGORY:Malware|SEVERITY:HIGH|DESC:Netcat shell

# Privilege Abuse
PARTIAL:privilege abuse|CATEGORY:Security|SEVERITY:HIGH|DESC:Privilege abuse
PARTIAL:sudo abuse|CATEGORY:Security|SEVERITY:HIGH|DESC:Sudo abuse
PARTIAL:suid abuse|CATEGORY:Security|SEVERITY:HIGH|DESC:SUID abuse

# Lateral Movement
PARTIAL:lateral movement|CATEGORY:APT|SEVERITY:HIGH|DESC:Lateral movement detected
PARTIAL:remote execution|CATEGORY:APT|SEVERITY:HIGH|DESC:Remote code execution
PARTIAL:pass the hash|CATEGORY:APT|SEVERITY:HIGH|DESC:Pass-the-hash attack

# APT Indicators
PARTIAL:apt|CATEGORY:APT|SEVERITY:HIGH|DESC:APT indicator
PARTIAL:advanced persistent|CATEGORY:APT|SEVERITY:HIGH|DESC:Advanced persistent threat
PARTIAL:targeted attack|CATEGORY:APT|SEVERITY:HIGH|DESC:Targeted attack
PARTIAL:nation state|CATEGORY:APT|SEVERITY:HIGH|DESC:Nation-state threat

# Web Shells
PARTIAL:web shell|CATEGORY:Malware|SEVERITY:HIGH|DESC:Web shell detected
REGEX:\.php.*cmd|CATEGORY:Malware|SEVERITY:HIGH|DESC:PHP command execution
PARTIAL:webshell|CATEGORY:Malware|SEVERITY:HIGH|DESC:Web shell variant

# Crypto/Blockchain
PARTIAL:monero|CATEGORY:Mining|SEVERITY:MEDIUM|DESC:Monero cryptocurrency
PARTIAL:bitcoin|CATEGORY:Mining|SEVERITY:LOW|DESC:Bitcoin reference
PARTIAL:xmrig|CATEGORY:Mining|SEVERITY:HIGH|DESC:XMRig cryptocurrency miner
PARTIAL:coinhive|CATEGORY:Mining|SEVERITY:HIGH|DESC:Coinhive mining script

# Browser Hijacking
PARTIAL:browser hijack|CATEGORY:Adware|SEVERITY:HIGH|DESC:Browser hijacking
PARTIAL:homepage changed|CATEGORY:Adware|SEVERITY:MEDIUM|DESC:Homepage modification
PARTIAL:search redirect|CATEGORY:Adware|SEVERITY:MEDIUM|DESC:Search redirection
PARTIAL:new tab override|CATEGORY:Adware|SEVERITY:MEDIUM|DESC:New tab override

# Suspicious Extensions
PARTIAL:browser extension|CATEGORY:Suspicious|SEVERITY:LOW|DESC:Browser extension activity
REGEX:extension.*inject|CATEGORY:Suspicious|SEVERITY:HIGH|DESC:Extension injection

# File Encryption (Ransomware)
PARTIAL:encrypted|CATEGORY:Ransomware|SEVERITY:HIGH|DESC:File encryption
PARTIAL:ransom|CATEGORY:Ransomware|SEVERITY:HIGH|DESC:Ransom demand
PARTIAL:decryption key|CATEGORY:Ransomware|SEVERITY:HIGH|DESC:Decryption key reference
REGEX:\.encrypted$|CATEGORY:Ransomware|SEVERITY:HIGH|DESC:Encrypted file extension
